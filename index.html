<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Memorice Matemático - 1° a 4° Medio</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 1em;
    background: #f5f5f5;
  }
  h1 {
    text-align: center;
    margin-bottom: 0.5em;
  }
  #controls {
    text-align: center;
    margin-bottom: 1em;
  }
  select, button {
    font-size: 1rem;
    padding: 0.4em 0.8em;
    margin: 0 0.5em;
  }
  #board {
    display: grid;
    grid-template-columns: repeat(4, 140px);
    grid-gap: 15px;
    justify-content: center;
    margin-bottom: 1em;
  }
  .card {
    background: #eee;
    border: 2px solid #ccc;
    height: 110px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1rem;
    cursor: pointer;
    user-select: none;
    color: black; /* cartas visibles desde el inicio */
    transition: background-color 0.3s, color 0.3s;
    padding: 0.5em;
    text-align: center;
    border-radius: 8px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
  }
  .card.flipped {
    background: #4caf50;
    color: black;
    cursor: default;
  }
  .card.matched {
    background: #2e7d32;
    color: white;
    cursor: default;
  }
  .card.wrong {
    background: #f44336;
    color: white;
    cursor: default;
  }
  #explanation {
    min-height: 3em;
    margin-bottom: 1em;
    font-style: italic;
    text-align: center;
    color: #333;
  }
  #scoreboard, #timer {
    font-weight: bold;
    font-size: 1.1rem;
    margin: 0.3em 1em;
  }
  #info-bar {
    text-align: center;
    margin-bottom: 1em;
  }

  .board-facil .card { border-color: #81c784; }
  .board-medio .card { border-color: #4caf50; }
  .board-dificil .card { border-color: #388e3c; }
  .board-extremo .card { border-color: #1b5e20; }
</style>
</head>
<body>

<h1>Memorice Matemático - 1° a 4° Medio</h1>

<div id="controls">
  Curso: 
  <select id="curso-select">
    <option value="1medio">1° Medio</option>
    <option value="2medio">2° Medio</option>
    <option value="3medio">3° Medio</option>
    <option value="4medio">4° Medio</option>
  </select>
  Dificultad: 
  <select id="dificultad-select">
    <option value="facil">Fácil</option>
    <option value="medio">Medio</option>
    <option value="dificil">Difícil</option>
    <option value="extremo">Extremo</option>
  </select>
  <button id="start-btn">Iniciar Juego</button>
</div>

<div id="info-bar">
  <span id="scoreboard">Puntaje: 0</span>
  <span id="timer">Tiempo: 00:00</span>
</div>

<div id="board" class="board-facil"></div>

<div id="explanation"></div>

<script>
  const bancoOperaciones = {
    "1medio": {
      "facil": [
        { pregunta: "Simplifica: (a + b)²", respuesta: "a² + 2ab + b²", explicacion: "Producto notable cuadrado de binomio" },
        { pregunta: "Suma: 2x + 3x", respuesta: "5x", explicacion: "Suma de términos semejantes" },
        { pregunta: "Resuelve: x + 3 = 7", respuesta: "4", explicacion: "Despeja x" },
        { pregunta: "Área rectángulo base 4 cm altura 5 cm", respuesta: "20", explicacion: "Área = base × altura" },
        { pregunta: "Representa datos en gráfico XY", respuesta: "Puntos en plano", explicacion: "Nube de puntos" },
        { pregunta: "Sistema: x + y = 3, x - y = 1", respuesta: "x=2, y=1", explicacion: "Suma y resta para despejar" },
        { pregunta: "Homotecia: escala 2, punto (3,4)", respuesta: "(6,8)", explicacion: "Multiplica coordenadas por escala" },
        { pregunta: "Simplifica: 3(x + 2)", respuesta: "3x + 6", explicacion: "Distribución" }
      ]
    }
  };

  const tiemposDificultad = { facil: 8 * 60 };

  const board = document.getElementById("board");
  const cursoSelect = document.getElementById("curso-select");
  const dificultadSelect = document.getElementById("dificultad-select");
  const startBtn = document.getElementById("start-btn");
  const explanationDiv = document.getElementById("explanation");
  const scoreboard = document.getElementById("scoreboard");
  const timerDisplay = document.getElementById("timer");

  let puntaje = 0;
  let cartasSeleccionadas = [];
  let bloqueoClick = false;

  function mezclarArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  function crearCartas() {
    puntaje = 0;
    actualizarPuntaje();
    cartasSeleccionadas = [];
    explanationDiv.textContent = "";

    const ejercicios = bancoOperaciones["1medio"]["facil"];
    const seleccion = mezclarArray(ejercicios).slice(0, 8);
    const cartas = [];
    seleccion.forEach((item, index) => {
      cartas.push({ id: index, tipo: "pregunta", text: item.pregunta, explicacion: item.explicacion });
      cartas.push({ id: index, tipo: "respuesta", text: item.respuesta, explicacion: item.explicacion });
    });

    mezclarArray(cartas);
    board.innerHTML = "";
    cartas.forEach(c => {
      const cardDiv = document.createElement("div");
      cardDiv.classList.add("card", "flipped"); // desde inicio volteadas
      cardDiv.dataset.id = c.id;
      cardDiv.dataset.tipo = c.tipo;
      cardDiv.dataset.text = c.text;
      cardDiv.dataset.explicacion = c.explicacion;
      cardDiv.textContent = c.text; // mostrar contenido desde el inicio
      cardDiv.addEventListener("click", manejarClickCarta);
      board.appendChild(cardDiv);
    });
  }

  function manejarClickCarta(e) {
    if (bloqueoClick) return;
    const carta = e.currentTarget;
    if (carta.classList.contains("matched")) return;

    cartasSeleccionadas.push(carta);

    if (cartasSeleccionadas.length === 2) {
      bloqueoClick = true;
      const [primera, segunda] = cartasSeleccionadas;
      if (primera.dataset.id === segunda.dataset.id && primera.dataset.tipo !== segunda.dataset.tipo) {
        primera.classList.add("matched");
        segunda.classList.add("matched");
        puntaje += 10;
        explanationDiv.textContent = "¡Correcto! " + primera.dataset.explicacion;
      } else {
        puntaje = Math.max(0, puntaje - 5);
        explanationDiv.textContent = "Incorrecto. " + (segunda.dataset.explicacion || "Revisa bien el ejercicio.");
      }
      setTimeout(() => {
        cartasSeleccionadas = [];
        bloqueoClick = false;
        explanationDiv.textContent = "";
        actualizarPuntaje();
      }, 1000);
    }
  }

  function actualizarPuntaje() {
    scoreboard.textContent = `Puntaje: ${puntaje}`;
  }

  startBtn.addEventListener("click", crearCartas);
</script>

</body>
</html>
